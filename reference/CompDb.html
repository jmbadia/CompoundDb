<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simple compound (metabolite) databases — CompDb • CompoundDb</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simple compound (metabolite) databases — CompDb" />
<meta property="og:description" content="CompDb objects provide access to general (metabolite) compound
annotations along with metadata information such as the annotation's
source, date and release version. The data is stored internally in a
database (usually an SQLite database).
hasMsMsSpectra returns TRUE if MS/MS spectrum data is
available in the database and FALSE otherwise." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CompoundDb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CompoundDb-usage.html">Usage of Annotation Resources with the CompoundDb Package</a>
    </li>
    <li>
      <a href="../articles/create-compounddb.html">Creating CompoundDb annotation resources</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/CompoundDb/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simple compound (metabolite) databases</h1>
    <small class="dont-index">Source: <a href='https://github.com/EuracBiomedicalResearch/CompoundDb/blob/master/R/CompDb.R'><code>R/CompDb.R</code></a>, <a href='https://github.com/EuracBiomedicalResearch/CompoundDb/blob/master/R/CompDb-methods.R'><code>R/CompDb-methods.R</code></a></small>
    <div class="hidden name"><code>CompDb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>CompDb</code> objects provide access to general (metabolite) compound
annotations along with <em>metadata</em> information such as the annotation's
source, date and release version. The data is stored internally in a
database (usually an SQLite database).</p>
<p><code>hasMsMsSpectra</code> returns <code>TRUE</code> if MS/MS spectrum data is
available in the database and <code>FALSE</code> otherwise.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>CompDb</span><span class='op'>(</span><span class='va'>x</span>, flags <span class='op'>=</span> <span class='fu'>RSQLite</span><span class='fu'>::</span><span class='va'><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>SQLITE_RO</a></span><span class='op'>)</span>

<span class='fu'>hasMsMsSpectra</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>src_compdb</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>tables</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>dbconn</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>Spectra</span><span class='op'>(</span><span class='va'>object</span>, columns <span class='op'>=</span> <span class='fu'>spectraVariables</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>, <span class='va'>filter</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>supportedFilters</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>metadata</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>spectraVariables</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>compoundVariables</span><span class='op'>(</span><span class='va'>object</span>, includeId <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CompDb</span>
<span class='fu'>compounds</span><span class='op'>(</span>
  <span class='va'>object</span>,
  columns <span class='op'>=</span> <span class='fu'>compoundVariables</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>,
  <span class='va'>filter</span>,
  return.type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"data.frame"</span>, <span class='st'>"tibble"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For <code>CompDb</code>: <code>character(1)</code> with the file name of the SQLite
compound database. Alternatively it is possible to provide the connection
to the database with parameter <code>x</code>.</p><pre><code>For all other methods: a `CompDb` object.
</code></pre></td>
    </tr>
    <tr>
      <th>flags</th>
      <td><p>flags passed to the SQLite database connection.
See <code>SQLite()</code>. Defaults to read-only, i.e. <code><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>RSQLite::SQLITE_RO</a></code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For all methods: a <code>CompDb</code> object.</p></td>
    </tr>
    <tr>
      <th>columns</th>
      <td><p>For <code>compounds</code>, <code>Spectra</code>: <code>character</code> with the names of the
database columns that should be retrieved. Use <code>compoundVariables</code> and/or
<code>spectraVariables</code> for a list of available column names.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>For <code>compounds</code> and <code>Spectra</code>: filter expression or
<code>AnnotationFilter()</code> defining a filter to be used to retrieve specific
elements from the database.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments. Currently not used.</p></td>
    </tr>
    <tr>
      <th>includeId</th>
      <td><p>for <code>compoundVariables</code>: <code>logical(1)</code> whether the comound
ID (column <code>"compound_id"</code>) should be included in the result. The
default is <code>includeIds = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>For <code>compounds</code>: either <code>"data.frame"</code> or <code>"tibble"</code> to
return the result as a <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame()</a></code> or <code>tibble()</code>, respectively.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>CompDb</code> objects should be created using the constructor function
<code>CompDb</code> providing the name of the (SQLite) database file providing
the compound annotation data.</p>
    <h2 class="hasAnchor" id="retrieve-annotations-from-the-database"><a class="anchor" href="#retrieve-annotations-from-the-database"></a>Retrieve annotations from the database</h2>

    


<p>Annotations/compound informations can be retrieved from a <code>CompDb</code> database
with the <code>compounds</code> and <code>Spectra</code> functions:</p><ul>
<li><p><code>compounds</code> extracts compound data from the <code>CompDb</code> object. In contrast
to <code>src_compdb</code> it returns the actual data as a <code>data.frame</code> (if
<code>return.type = "data.frame"</code>) or a <code><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble::tibble()</a></code> (if
<code>return.type = "tibble"</code>). A <code>compounds</code> call will always return all
elements from the <em>ms_compound</em> table (unless a <code>filter</code> is used).</p></li>
<li><p><code>Spectra</code> extract spectra from the database and returns them as a
<code><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra()</a></code> object from the <code>Spectra</code> package. Additional annotations
requested with the <code>columns</code> parameter are added as additional spectra
variables.</p></li>
</ul>

    <h2 class="hasAnchor" id="general-functions"><a class="anchor" href="#general-functions"></a>General functions</h2>

    

<ul>
<li><p><code>CompDb</code>: connect to a compound database.</p></li>
<li><p><code>compoundVariables</code>: returns all available columns/database fields for
compounds.</p></li>
<li><p><code>dbconn</code>: returns the connection (of type <code>DBIConnection</code>) to the database.</p></li>
<li><p><code>metadata</code>: returns general meta data of the compound database.</p></li>
<li><p><code>spectraVariables</code>: returns all spectra variables (i.e. columns) available
in the <code>CompDb</code>.</p></li>
<li><p><code>src_compdb</code> provides access to the <code>CompDb</code>'s database <em>via</em>
the functionality from the <code>dplyr</code>/<code>dbplyr</code> package.</p></li>
<li><p><code>supportedFilters</code>: provides an overview of the filters that can be
applied on a <code>CompDb</code> object to extract only specific data from the
database.</p></li>
<li><p><code>tables</code>: returns a named <code>list</code> (names being table names) with
the fields/columns from each table in the database.</p></li>
</ul>

    <h2 class="hasAnchor" id="filtering-the-database"><a class="anchor" href="#filtering-the-database"></a>Filtering the database</h2>

    


<p>Data access methods such as <code>compounds</code> and <code>Spectra</code> allow to filter the
results using specific filter classes and expressions. Filtering uses the
concepts from Bioconductor's <code>AnnotationFilter</code> package. All information
for a certain compound with the ID <code>"HMDB0000001"</code> can for example be
retrieved by passing the filter expression
<code>filter = ~ compound_id == "HMDB0000001"</code> to the <code>compounds</code> function.</p>
<p>Use the supportedFilters function on the CompDb object to get a list of
all supported filters. See also examples below or the usage vignette for
details.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='createCompDb.html'>createCompDb()</a></code> for the function to create a SQLite compound database.</p>
<p><code><a href='Filter-classes.html'>CompoundIdFilter()</a></code> for filters that can be used on the <code>CompDb</code> database.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'>## We load a small compound test database based on MassBank which is</span></span>
<span class='r-in'><span class='co'>## distributed with this package.</span></span>
<span class='r-in'><span class='va'>cdb</span> <span class='op'>&lt;-</span> <span class='fu'>CompDb</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"sql/CompDb.MassBank.sql"</span>, package <span class='op'>=</span> <span class='st'>"CompoundDb"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>cdb</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> class: CompDb </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  data source: MassBank </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  version: 2020.09 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  organism: NA </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  compound count: 70 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  MS/MS spectra count: 70 </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get general metadata information from the database, such as originating</span></span>
<span class='r-in'><span class='co'>## source and version:</span></span>
<span class='r-in'><span class='fu'>metadata</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                 name                         value</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1             source                      MassBank</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2                url https://massbank.eu/MassBank/</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3     source_version                       2020.09</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4        source_date                    1603272565</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5           organism                          &lt;NA&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6   db_creation_date      Thu Oct 22 08:45:31 2020</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7 supporting_package                    CompoundDb</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  supporting_object                        CompDb</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## List all available compound annotations/fields</span></span>
<span class='r-in'><span class='fu'>compoundVariables</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "formula"   "exactmass" "smiles"    "inchi"     "inchikey"  "cas"      </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [7] "pubchem"   "name"     </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract a data.frame with these annotations for all compounds</span></span>
<span class='r-in'><span class='fu'>compounds</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       formula exactmass</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1    C10H10O3  178.0630</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2   C25H47NO9  505.3251</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3    C17H12O6  312.0634</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4    C17H14O6  314.0790</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5    C17H12O7  328.0583</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6    C17H14O7  330.0739</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7    C17H12O7  328.0583</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  C20H20N2O3  336.1474</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9    C15H16O6  292.0947</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10   C14H10O5  258.0528</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11   C15H12O5  272.0685</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12   C16H16O8  336.0845</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                   smiles</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                                                            CC1CC2=C(C(=CC=C2)O)C(=O)O1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  CC[C@@H](C)[C@H]([C@H](C[C@@H](C)CCCCCC[C@H](C[C@@H](CN)O)O)OC(=O)CC(CC(=O)O)C(=O)O)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3                               COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4[C@@H]5C=CO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4                                COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4[C@@H]5CCO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5                              COC1=C2C3=C(C(=O)OCC3)C(=O)OC2=C4[C@@H]5C=CO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6                               COC1=C2C3=C(C(=O)OCC3)C(=O)OC2=C4[C@@H]5CCO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7                            COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4C(=C1)O[C@@H]5[C@]4(C=CO5)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8                    CC(=O)C1=C([C@@H]2[C@@H]3[C@@H](CC4=C5C3=CNC5=CC=C4)C(N2C1=O)(C)C)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9                                 C[C@]12C[C@@H]([C@H](C=C1C3=CC(=CC(=C3C(=O)O2)O)OC)O)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10                                              CC1=CC(=CC2=C1C3=CC(=CC(=C3C(=O)O2)O)O)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11                                             CC1=CC(=CC2=C1C3=CC(=CC(=C3C(=O)O2)O)OC)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12                    C[C@]1([C@@H]([C@H](C2=C([C@H]1O)C(=O)C3=CC(=CC(=C3C2=O)O)OC)O)O)O</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                                                                                                                                            inchi</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                                                                                                                                        InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/h2-4,6,11H,5H2,1H3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(25(33)34)12-22(29)30)11-16(2)9-7-5-6-8-10-19(27)14-20(28)15-26/h16-21,24,27-28,32H,4-15,26H2,1-3H3,(H,29,30)(H,33,34)/t16-,17+,18?,19+,20-,21-,24+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3                                                                                 InChI=1S/C17H12O6/c1-20-10-6-11-14(8-4-5-21-17(8)22-11)15-13(10)7-2-3-9(18)12(7)16(19)23-15/h4-6,8,17H,2-3H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4                                                                                   InChI=1S/C17H14O6/c1-20-10-6-11-14(8-4-5-21-17(8)22-11)15-13(10)7-2-3-9(18)12(7)16(19)23-15/h6,8,17H,2-5H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5                                                                             InChI=1S/C17H12O7/c1-20-9-6-10-12(8-3-5-22-17(8)23-10)14-11(9)7-2-4-21-15(18)13(7)16(19)24-14/h3,5-6,8,17H,2,4H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6                                                                                 InChI=1S/C17H14O7/c1-20-9-6-10-12(8-3-5-22-17(8)23-10)14-11(9)7-2-4-21-15(18)13(7)16(19)24-14/h6,8,17H,2-5H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7                                                                            InChI=1S/C17H12O7/c1-21-9-6-10-13(17(20)4-5-22-16(17)23-10)14-12(9)7-2-3-8(18)11(7)15(19)24-14/h4-6,16,20H,2-3H2,1H3/t16-,17-/m1/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8                                                      InChI=1S/C20H20N2O3/c1-9(23)14-18(24)17-16-11-8-21-13-6-4-5-10(15(11)13)7-12(16)20(2,3)22(17)19(14)25/h4-6,8,12,16-17,21,24H,7H2,1-3H3/t12-,16+,17+/m1/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9                                                                                InChI=1S/C15H16O6/c1-15-6-12(18)10(16)5-9(15)8-3-7(20-2)4-11(17)13(8)14(19)21-15/h3-5,10,12,16-18H,6H2,1-2H3/t10-,12-,15-/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10                                                                                                                     InChI=1S/C14H10O5/c1-6-2-7(15)5-11-12(6)9-3-8(16)4-10(17)13(9)14(18)19-11/h2-5,15-17H,1H3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11                                                                                                               InChI=1S/C15H12O5/c1-7-3-8(16)4-12-13(7)10-5-9(19-2)6-11(17)14(10)15(18)20-12/h3-6,16-17H,1-2H3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12                                                                   InChI=1S/C16H16O8/c1-16(23)14(21)10-9(13(20)15(16)22)12(19)8-6(11(10)18)3-5(24-2)4-7(8)17/h3-4,13-15,17,20-23H,1-2H3/t13-,14+,15+,16-/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                       inchikey         cas       pubchem</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  KWILGNNWGSNMPA-UHFFFAOYSA-N  17397-85-2     CID:28516</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2  CTXQVLLVFBNZKL-YVEDVMJTSA-N 149849-90-1 CID:102004382</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3  OQIQSTLJSLGHID-WNWIJWBNSA-N   1162-65-8    CID:186907</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4  WWSYXEZEXMQWHT-WNWIJWBNSA-N   7220-81-7   CID:2724360</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5  XWIYFDMXXLINPU-WNWIJWBNSA-N   1165-39-5   CID:2724361</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6  WPCVRWVBBXIRMA-WNWIJWBNSA-N   7241-98-7   CID:2724362</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7  MJBWDEQAUQTVKK-IAGOWNOFSA-N   6795-23-9  CID:15558498</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  SZINUGQCTHLQAZ-DQYPLSBCSA-N  18172-33-3  CID:54682463</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9  MMHTXEATDNFMMY-WBIUFABUSA-N  29752-43-0     CID:34687</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10 CEBXXEKPIIDJHL-UHFFFAOYSA-N    641-38-3   CID:5359485</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11 LCSDQFNUYFTXMT-UHFFFAOYSA-N  23452-05-3   CID:5360741</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12 VSMBLBOUQJNJIL-JJXSEGSLSA-N  22268-16-2     CID:89644</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                        name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                   Mellein</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2              AAL toxin TB</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3              Aflatoxin B1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4              Aflatoxin B2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5              Aflatoxin G1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6              Aflatoxin G2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7              Aflatoxin M1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8  alpha-Cyclopiazonic acid</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9                 Altenuene</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10              Alternariol</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11 Alternariol methyl ether</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12           Altersolanol A</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Add also the synonyms (aliases) for the compounds. This will cause the</span></span>
<span class='r-in'><span class='co'>## tables compound and synonym to be joined. The elements of the compound_id</span></span>
<span class='r-in'><span class='co'>## and name are now no longer unique</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>compounds</span><span class='op'>(</span><span class='va'>cdb</span>, columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name"</span>, <span class='st'>"synonym"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1      Mellein</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2      Mellein</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3      Mellein</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 AAL toxin TB</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5 AAL toxin TB</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6 Aflatoxin B1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                                               synonym</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1                                                                      8-hydroxy-3-methyl-3,4-dihydroisochromen-1-one</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2                                                                                                             Mellein</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3                                                                                                            Ochracin</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4 2-[2-[(3R,4R,5S,7S,14R,16S)-17-amino-4,14,16-trihydroxy-3,7-dimethylheptadecan-5-yl]oxy-2-oxoethyl]butanedioic acid</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5                                                                                                        AAL toxin TB</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6                  (6aR,9aS)-4-Methoxy-2,3,6a,9a-tetrahydrocyclopenta[c]furo[3',2':4,5]furo[2,3-h]chromene-1,11-dione</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## List all database tables and their columns</span></span>
<span class='r-in'><span class='fu'>tables</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $ms_compound</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "compound_id" "formula"     "exactmass"   "smiles"      "inchi"      </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [6] "inchikey"    "cas"         "pubchem"     "name"       </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $msms_spectrum</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] "accession"             "spectrum_name"         "date"                 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [4] "authors"               "license"               "copyright"            </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [7] "publication"           "ms_level"              "polarity"             </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [10] "splash"                "compound_id"           "precursor_intensity"  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [13] "precursor_mz"          "adduct"                "ionization"           </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [16] "ionization_voltage"    "fragmentation_mode"    "collision_energy_text"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [19] "instrument"            "instrument_type"       "precursor_mz_text"    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [22] "spectrum_id"           "collision_energy"      "predicted"            </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [25] "msms_mz_range_min"     "msms_mz_range_max"    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $msms_spectrum_peak</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "spectrum_id" "mz"          "intensity"   "peak_id"    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $synonym</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] "compound_id" "synonym"    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Any of these columns can be used in the `compounds` call to retrieve</span></span>
<span class='r-in'><span class='co'>## the specific annotations. The corresponding database tables will then be</span></span>
<span class='r-in'><span class='co'>## joined together</span></span>
<span class='r-in'><span class='fu'>compounds</span><span class='op'>(</span><span class='va'>cdb</span>, columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"formula"</span>, <span class='st'>"publication"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       formula</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1    C10H10O3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2   C25H47NO9</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3    C17H12O6</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4    C17H14O6</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5    C17H12O7</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6    C17H14O7</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7  C20H20N2O3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8    C15H16O6</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9    C14H10O5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10   C15H12O5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11   C16H16O8</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                                                                                                                                                                                                              publication</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2                  Renaud, J. B.; Kelman, M. J.; Qi, T. F.; Seifert, K. A.; Sumarah, M. W. Product Ion Filtering with Rapid Polarity Switching for the Detection of All Fumonisins and AAL-Toxins. Rapid Communications in Mass Spectrometry 2015, 29 (22), 2131–9. DOI:10.1002/rcm.7374</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 6  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8                                                                                                                                                                                                                                                                                   &lt;NA&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9  Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10 Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11 Renaud, J. B.; Sumarah, M. W. Data Independent Acquisition-Digital Archiving Mass Spectrometry: Application to Single Kernel Mycotoxin Analysis of Fusarium Graminearum Infected Maize. Analytical and Bioanalytical Chemistry 2016, 408 (12), 3083–91. DOI:10.1007/s00216-016-9391-5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Create a Spectra object with all MS/MS spectra from the database.</span></span>
<span class='r-in'><span class='va'>sps</span> <span class='op'>&lt;-</span> <span class='fu'>Spectra</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>sps</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MSn data (Spectra) with 70 spectra in a MsBackendCompDb backend:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       msLevel     rtime scanIndex</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1           2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2           2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3           2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4           2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5           2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ...       ...       ...       ...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 66          2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 67          2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 68          2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 69          2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 70          2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  ... 38 more variables/columns.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  data source: MassBank </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  version: 2020.09 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  organism: NA </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract spectra for a specific compound.</span></span>
<span class='r-in'><span class='va'>sps</span> <span class='op'>&lt;-</span> <span class='fu'>Spectra</span><span class='op'>(</span><span class='va'>cdb</span>, filter <span class='op'>=</span> <span class='op'>~</span> <span class='va'>name</span> <span class='op'>==</span> <span class='st'>"Mellein"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>sps</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> MSn data (Spectra) with 5 spectra in a MsBackendCompDb backend:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     msLevel     rtime scanIndex</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1         2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2         2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3         2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4         2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5         2        NA        NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  ... 39 more variables/columns.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  data source: MassBank </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  version: 2020.09 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  organism: NA </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## List all available annotations for MS/MS spectra</span></span>
<span class='r-in'><span class='fu'>spectraVariables</span><span class='op'>(</span><span class='va'>sps</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] "msLevel"                 "rtime"                  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [3] "acquisitionNum"          "scanIndex"              </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [5] "dataStorage"             "dataOrigin"             </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [7] "centroided"              "smoothed"               </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [9] "polarity"                "precScanNum"            </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [11] "precursorMz"             "precursorIntensity"     </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [13] "precursorCharge"         "collisionEnergy"        </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [15] "isolationWindowLowerMz"  "isolationWindowTargetMz"</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [17] "isolationWindowUpperMz"  "accession"              </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [19] "spectrum_name"           "date"                   </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [21] "authors"                 "license"                </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [23] "copyright"               "publication"            </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [25] "splash"                  "compound_id"            </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [27] "adduct"                  "ionization"             </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [29] "ionization_voltage"      "fragmentation_mode"     </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [31] "collision_energy_text"   "instrument"             </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [33] "instrument_type"         "precursorMz_text"       </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [35] "spectrum_id"             "collision_energy"       </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [37] "predicted"               "msms_mz_range_min"      </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [39] "msms_mz_range_max"       "name"                   </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get access to the m/z values of these</span></span>
<span class='r-in'><span class='fu'>mz</span><span class='op'>(</span><span class='va'>sps</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> NumericList of length 5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [["1"]] 133.0648 151.0754 155.9743 161.0597 179.0703</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [["2"]] 133.0648 151.0754 155.9745 161.0597 179.0703</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [["3"]] 105.0699 133.0648 151.0754 161.0597 179.0703</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [["4"]] 105.0699 133.0648 151.0754 161.0597 179.0703</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [["5"]] 105.0699 115.0542 133.0648 151.0754 161.0597 179.0703</span>
<span class='r-in'></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/RforMassSpectrometry/Spectra'>Spectra</a></span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: BiocParallel</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: ProtGenerics</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Attaching package: ‘ProtGenerics’</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following object is masked from ‘package:stats’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     smooth</span>
<span class='r-in'><span class='co'>## Plot the first spectrum</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/Spectra/man/spectra-plotting.html'>plotSpectra</a></span><span class='op'>(</span><span class='va'>sps</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-plt'><img src='CompDb-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#########</span></span>
<span class='r-in'><span class='co'>## Filtering the database</span></span>
<span class='r-in'><span class='co'>##</span></span>
<span class='r-in'><span class='co'>## Get all compounds with an exact mass between 310 and 320</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html'>compounds</a></span><span class='op'>(</span><span class='va'>cdb</span>, filter <span class='op'>=</span> <span class='op'>~</span> <span class='va'>exactmass</span> <span class='op'>&gt;</span> <span class='fl'>310</span> <span class='op'>&amp;</span> <span class='va'>exactmass</span> <span class='op'>&lt;</span> <span class='fl'>320</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>res</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    formula exactmass                                                   smiles</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 C17H12O6  312.0634 COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4[C@@H]5C=CO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 C17H14O6  314.0790  COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4[C@@H]5CCO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                                                            inchi</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 InChI=1S/C17H12O6/c1-20-10-6-11-14(8-4-5-21-17(8)22-11)15-13(10)7-2-3-9(18)12(7)16(19)23-15/h4-6,8,17H,2-3H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2   InChI=1S/C17H14O6/c1-20-10-6-11-14(8-4-5-21-17(8)22-11)15-13(10)7-2-3-9(18)12(7)16(19)23-15/h6,8,17H,2-5H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                      inchikey       cas     pubchem         name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 OQIQSTLJSLGHID-WNWIJWBNSA-N 1162-65-8  CID:186907 Aflatoxin B1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 WWSYXEZEXMQWHT-WNWIJWBNSA-N 7220-81-7 CID:2724360 Aflatoxin B2</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get all compounds that have an H14 in their formula.</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html'>compounds</a></span><span class='op'>(</span><span class='va'>cdb</span>, filter <span class='op'>=</span> <span class='fu'><a href='Filter-classes.html'>FormulaFilter</a></span><span class='op'>(</span><span class='st'>"H14"</span>, <span class='st'>"contains"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>res</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    formula exactmass                                                   smiles</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 C17H14O6  314.0790  COC1=C2C3=C(C(=O)CC3)C(=O)OC2=C4[C@@H]5CCO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 C17H14O7  330.0739 COC1=C2C3=C(C(=O)OCC3)C(=O)OC2=C4[C@@H]5CCO[C@@H]5OC4=C1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                                                                                            inchi</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1   InChI=1S/C17H14O6/c1-20-10-6-11-14(8-4-5-21-17(8)22-11)15-13(10)7-2-3-9(18)12(7)16(19)23-15/h6,8,17H,2-5H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 InChI=1S/C17H14O7/c1-20-9-6-10-12(8-3-5-22-17(8)23-10)14-11(9)7-2-4-21-15(18)13(7)16(19)24-14/h6,8,17H,2-5H2,1H3/t8-,17+/m0/s1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                      inchikey       cas     pubchem         name</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1 WWSYXEZEXMQWHT-WNWIJWBNSA-N 7220-81-7 CID:2724360 Aflatoxin B2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2 WPCVRWVBBXIRMA-WNWIJWBNSA-N 7241-98-7 CID:2724362 Aflatoxin G2</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#########</span></span>
<span class='r-in'><span class='co'>## Using CompDb with the *tidyverse*</span></span>
<span class='r-in'><span class='co'>##</span></span>
<span class='r-in'><span class='co'>## Using return.type = "tibble" the result will be returned as a "tibble"</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html'>compounds</a></span><span class='op'>(</span><span class='va'>cdb</span>, return.type <span class='op'>=</span> <span class='st'>"tibble"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># A tibble: 12 x 8</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    formula  exactmass smiles        inchi        inchikey   cas   pubchem name  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>        <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>        <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 1</span> C10H10O3      178. CC1CC2=C(C(=… InChI=1S/C1… KWILGNNWG… 1739… CID:28… Melle…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 2</span> C25H47N…      505. CC[C@@H](C)[… InChI=1S/C2… CTXQVLLVF… 1498… CID:10… AAL t…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 3</span> C17H12O6      312. COC1=C2C3=C(… InChI=1S/C1… OQIQSTLJS… 1162… CID:18… Aflat…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 4</span> C17H14O6      314. COC1=C2C3=C(… InChI=1S/C1… WWSYXEZEX… 7220… CID:27… Aflat…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 5</span> C17H12O7      328. COC1=C2C3=C(… InChI=1S/C1… XWIYFDMXX… 1165… CID:27… Aflat…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 6</span> C17H14O7      330. COC1=C2C3=C(… InChI=1S/C1… WPCVRWVBB… 7241… CID:27… Aflat…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 7</span> C17H12O7      328. COC1=C2C3=C(… InChI=1S/C1… MJBWDEQAU… 6795… CID:15… Aflat…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 8</span> C20H20N…      336. CC(=O)C1=C([… InChI=1S/C2… SZINUGQCT… 1817… CID:54… alpha…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 9</span> C15H16O6      292. C[C@]12C[C@@… InChI=1S/C1… MMHTXEATD… 2975… CID:34… Alten…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>10</span> C14H10O5      258. CC1=CC(=CC2=… InChI=1S/C1… CEBXXEKPI… 641-… CID:53… Alter…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>11</span> C15H12O5      272. CC1=CC(=CC2=… InChI=1S/C1… LCSDQFNUY… 2345… CID:53… Alter…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>12</span> C16H16O8      336. C[C@]1([C@@H… InChI=1S/C1… VSMBLBOUQ… 2226… CID:89… Alter…</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Use the CompDb in a dplyr setup</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Attaching package: ‘dplyr’</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:S4Vectors’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     first, intersect, rename, setdiff, setequal, union</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:BiocGenerics’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     combine, intersect, setdiff, union</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     filter, lag</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class='r-in'><span class='va'>src_cmp</span> <span class='op'>&lt;-</span> <span class='fu'>src_compdb</span><span class='op'>(</span><span class='va'>cdb</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>src_cmp</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> src:  sqlite 3.35.5 [/__w/_temp/Library/CompoundDb/sql/CompDb.MassBank.sql]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> tbls: metadata, ms_compound, msms_spectrum, msms_spectrum_peak, synonym</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Get a tbl for the ms_compound table</span></span>
<span class='r-in'><span class='va'>cmp_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/tbl.html'>tbl</a></span><span class='op'>(</span><span class='va'>src_cmp</span>, <span class='st'>"ms_compound"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extract the id, name and inchi</span></span>
<span class='r-in'><span class='va'>cmp_tbl</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>compound_id</span>, <span class='va'>name</span>, <span class='va'>inchi</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/compute.html'>collect</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># A tibble: 70 x 3</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    compound_id name       inchi                                                 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>                                                 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 1</span> 1           Mellein    InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 2</span> 2           Mellein    InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 3</span> 3           Mellein    InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 4</span> 4           Mellein    InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 5</span> 5           Mellein    InChI=1S/C10H10O3/c1-6-5-7-3-2-4-8(11)9(7)10(12)13-6/…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 6</span> 6           AAL toxin… InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 7</span> 7           AAL toxin… InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 8</span> 8           AAL toxin… InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'> 9</span> 9           AAL toxin… InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #BCBCBC;'>10</span> 10          AAL toxin… InChI=1S/C25H47NO9/c1-4-17(3)24(32)21(35-23(31)13-18(…</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #949494;'># … with 60 more rows</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Jan Stanstrup, Johannes Rainer.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


